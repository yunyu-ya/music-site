<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>天空突然下起雨</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap');

    body {
      font-family: 'Noto Sans JP', Arial, sans-serif;
      background: url("https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/pexels-alex-andrews-271121-816608.jpg") no-repeat center center fixed;
      background-size: cover;
      color: #eee;
      margin: 0;
      padding: 1rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      backdrop-filter: blur(6px);
    }
    header {
      text-align: center;
      margin-bottom: 1rem;
      background-color: rgba(0,0,0,0.5);
      padding: 0.5rem;
      border-radius: 8px;
    }
    header h1 {
      color: #d1b3ff;
      text-shadow: 0 0 8px rgba(209, 179, 255, 0.8);
      margin: 0;
    }
    #now-playing {
      margin-top: 0.5rem;
      font-weight: 600;
      color: #ccc;
      text-align: center;
      font-size: 1rem;
      font-style: italic;
    }
    .track {
      background: rgba(34, 34, 34, 0.7);
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .track h2 {
      margin: 0 0 0.5rem 0;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
      background: rgba(0,0,0,0.5);
      padding: 0.5rem;
      border-radius: 8px;
      flex-wrap: wrap;
    }

    button.play-btn,
    #main-play-btn {
      font-family: 'Noto Sans JP', Arial, sans-serif;
      color: #fff;
      background: #6a4fbf;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      cursor: pointer;
      user-select: none;
      min-width: 70px;
      font-weight: 600;
      font-size: 1rem;
      transition: background-position 3s ease infinite;
      box-shadow: 0 0 10px #6a4fbf99;
    }
    button.play-btn.playing,
    #main-play-btn.playing {
      background: linear-gradient(270deg, #6a4fbf, #7e66d1, #5a3db3, #6a4fbf);
      background-size: 800% 800%;
      animation: gradientAnimation 8s ease infinite;
      box-shadow: 0 0 18px #7e66d1cc;
    }
    #main-play-btn.paused {
      animation: none;
    }

    /* 三個播放模式按鈕 */
    .controls .mode-btn {
      font-family: 'Noto Sans JP', Arial, sans-serif;
      color: #fff;
      background: #593f99;
      border: none;
      padding: 0.4rem 0.8rem;
      border-radius: 25px;
      cursor: pointer;
      user-select: none;
      font-weight: 600;
      font-size: 0.9rem;
      box-shadow: 0 0 8px #593f9950;
      transition: background-position 3s ease infinite;
    }
    .controls .mode-btn.active {
      background: linear-gradient(270deg, #6a4fbf, #7e66d1, #5a3db3, #6a4fbf);
      background-size: 800% 800%;
      animation: gradientAnimation 8s ease infinite;
      box-shadow: 0 0 15px #7e66d1cc;
    }

    @keyframes gradientAnimation {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }

    input[type=range] {
      flex-grow: 1;
      cursor: pointer;
    }
    .time-display {
      width: 80px;
      text-align: center;
      font-size: 0.9rem;
      user-select: none;
      color: #ddd;
    }
  </style>
</head>
<body>
  <header>
    <h1>當天空突然下起雨 妳是否會記得我還在等妳</h1>
    <div id="now-playing" aria-live="polite">尚未播放任何歌曲</div>
  </header>

  <div id="tracks-container">
    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《深井》.mp3">
      <h2>《深井》</h2>
      <button class="play-btn" aria-label="播放 《深井》">▶️ Play</button>
      <p>融入日系風味的旋律，帶有濃厚的情感。</p>
    </section>

    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《雲下的聲音》.mp3">
      <h2>《雲下的聲音》</h2>
      <button class="play-btn" aria-label="播放 《雲下的聲音》">▶️ Play</button>
      <p>我還能聽見妳嗎??。</p>
    </section>
    
    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《三樓到六樓的距離》.mp3">
      <h2>《三樓到六樓的距離》</h2>
      <button class="play-btn" aria-label="播放 《三樓到六樓的距離》">▶️ Play</button>
      <p>關於我與樓上的故事。</p>
    </section>
    
    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《聽不見你了》-男女合唱.mp3">
      <h2>《聽不見你了》-男女合唱</h2>
      <button class="play-btn" aria-label="播放 《聽不見你了》-男女合唱">▶️ Play</button>
      <p>一首感性的男女深情對唱。</p>
    </section>

    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《最後一頁》.mp3">
      <h2>《最後一頁》</h2>
      <button class="play-btn" aria-label="播放 《最後一頁》">▶️ Play</button>
      <p>帶有故事感的旋律，帶你翻開最後一頁。</p>
    </section>

    <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《當你不記得我》 .mp3">
      <h2>《當你不記得我》</h2>
      <button class="play-btn" aria-label="播放 《當你不記得我》">▶️ Play</button>
      <p>感傷的抒情曲，觸動心弦。</p>
    </section>

      <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《是妳在唱》.mp3">
      <h2>《是妳在唱》</h2>
      <button class="play-btn" aria-label="播放 《是妳在唱》">▶️ Play</button>
      <p>祝賀阿楓生日快樂,願她的歌聲永不熄。</p>
    </section>

      <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/《笑聲過境時》.mp3">
      <h2>《笑聲過境時》</h2>
      <button class="play-btn" aria-label="播放 《笑聲過境時》">▶️ Play</button>
      <p>祝賀我們墨瑤生日創作,願她的笑聲長存。</p>
    </section>

      <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/邊界之外.mp3">
      <h2>邊界之外</h2>
      <button class="play-btn" aria-label="播放 邊界之外">▶️ Play</button>
      <p>我屬於邊界的哪邊?。</p>
    </section>

      <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/鋼牆裡的風.mp3">
      <h2>鋼牆裡的風</h2>
      <button class="play-btn" aria-label="播放 鋼牆裡的風">▶️ Play</button>
      <p>人生的意義到底為何?。</p>
    </section>
    
      <section class="track" data-audio="https://raw.githubusercontent.com/yunyu-ya/music-site/音樂/迷宮裡的火.mp3">
      <h2>迷宮裡的火</h2>
      <button class="play-btn" aria-label="播放 迷宮裡的火">▶️ Play</button>
      <p>真正的現實就是這樣。</p>
    </section>
  </div>

  <div class="controls">
    <button id="prev-btn">⏪</button>
    <button id="main-play-btn" class="paused">▶️</button>
    <button id="next-btn">⏩</button>

    <button id="loop-all-btn" class="mode-btn active" title="循環全部">循環全部</button>
    <button id="loop-one-btn" class="mode-btn" title="單曲循環">單曲循環</button>
    <button id="shuffle-btn" class="mode-btn" title="隨機播放">隨機播放</button>

    <span class="time-display" id="current-time">0:00</span>
    <input type="range" id="progress-bar" min="0" max="100" value="0" />
    <span class="time-display" id="duration">0:00</span>
  </div>

  <input type="range" id="volume-bar" min="0" max="100" value="100" style="width: 100%; margin-top: 0.5rem;" />

  <audio id="audio-player" preload="auto"></audio>

  <script>
    const audioPlayer = document.getElementById('audio-player');
    const playButtons = document.querySelectorAll('.play-btn');
    const mainPlayBtn = document.getElementById('main-play-btn');
    const progressBar = document.getElementById('progress-bar');
    const volumeBar = document.getElementById('volume-bar');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');

    // 播放模式按鈕
    const loopAllBtn = document.getElementById('loop-all-btn');
    const loopOneBtn = document.getElementById('loop-one-btn');
    const shuffleBtn = document.getElementById('shuffle-btn');

    const currentTimeEl = document.getElementById('current-time');
    const durationEl = document.getElementById('duration');
    const nowPlayingEl = document.getElementById('now-playing');

    let currentTrackIndex = -1;
    let tracks = [];

    // 0=循環全部, 1=單曲循環, 2=隨機播放
    let playMode = 0;

    // 初始化播放清單
    playButtons.forEach((btn, index) => {
      const trackSection = btn.closest('.track');
      tracks.push({
        audio: trackSection.getAttribute('data-audio'),
        title: trackSection.querySelector('h2').textContent
      });

      btn.addEventListener('click', () => {
        if(currentTrackIndex === index){
          if(audioPlayer.paused){
            audioPlayer.play();
            updatePlayBtn(btn, true);
            mainPlayBtn.textContent = '⏸';
            mainPlayBtn.classList.add('playing');
            mainPlayBtn.classList.remove('paused');
          } else {
            audioPlayer.pause();
            updatePlayBtn(btn, false);
            mainPlayBtn.textContent = '▶️';
            mainPlayBtn.classList.remove('playing');
            mainPlayBtn.classList.add('paused');
          }
        } else {
          loadTrack(index);
          playTrack();
        }
      });
    });

    function updateNowPlaying(){
      if(currentTrackIndex === -1){
        nowPlayingEl.textContent = '尚未播放任何歌曲';
      } else {
        nowPlayingEl.textContent = `正在播放：${tracks[currentTrackIndex].title}`;
      }
    }

    function loadTrack(index){
      currentTrackIndex = index;
      audioPlayer.src = tracks[index].audio;
      updateAllPlayButtons();
      mainPlayBtn.textContent = '⏸';
      mainPlayBtn.classList.add('playing');
      mainPlayBtn.classList.remove('paused');
      updateNowPlaying();

      // 滾動目前播放歌曲區塊到視窗中央
      const trackSections = document.querySelectorAll('.track');
      if(trackSections[index]){
        trackSections[index].scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function playTrack(){
      audioPlayer.play().catch(() => {
        alert('無法播放音樂檔案');
      });
      updateAllPlayButtons(true);
      mainPlayBtn.textContent = '⏸';
      mainPlayBtn.classList.add('playing');
      mainPlayBtn.classList.remove('paused');
      updateNowPlaying();
    }

    function pauseTrack(){
      audioPlayer.pause();
      updateAllPlayButtons(false);
      mainPlayBtn.textContent = '▶️';
      mainPlayBtn.classList.remove('playing');
      mainPlayBtn.classList.add('paused');
    }

    mainPlayBtn.addEventListener('click', () => {
      if(currentTrackIndex === -1 && tracks.length > 0){
        loadTrack(0);
        playTrack();
      } else if(audioPlayer.paused){
        playTrack();
      } else {
        pauseTrack();
      }
    });

    prevBtn.addEventListener('click', () => {
      if(tracks.length === 0) return;
      currentTrackIndex = (currentTrackIndex - 1 + tracks.length) % tracks.length;
      loadTrack(currentTrackIndex);
      playTrack();
    });

    nextBtn.addEventListener('click', () => {
      if(tracks.length === 0) return;
      currentTrackIndex = (currentTrackIndex + 1) % tracks.length;
      loadTrack(currentTrackIndex);
      playTrack();
    });

    // 播放模式按鈕互動
    function setPlayMode(mode){
      playMode = mode;
      [loopAllBtn, loopOneBtn, shuffleBtn].forEach(btn => btn.classList.remove('active'));
      if(mode === 0) loopAllBtn.classList.add('active');
      else if(mode === 1) loopOneBtn.classList.add('active');
      else if(mode === 2) shuffleBtn.classList.add('active');
    }

    loopAllBtn.addEventListener('click', () => setPlayMode(0));
    loopOneBtn.addEventListener('click', () => setPlayMode(1));
    shuffleBtn.addEventListener('click', () => setPlayMode(2));

    audioPlayer.addEventListener('ended', () => {
      if(tracks.length === 0) return;

      if(playMode === 0){ // 循環全部
        nextBtn.click();
      } else if(playMode === 1){ // 單曲循環
        audioPlayer.currentTime = 0;
        audioPlayer.play();
      } else if(playMode === 2){ // 隨機播放
        let randomIndex = currentTrackIndex;
        while(randomIndex === currentTrackIndex && tracks.length > 1){
          randomIndex = Math.floor(Math.random() * tracks.length);
        }
        loadTrack(randomIndex);
        playTrack();
      }
    });

    audioPlayer.addEventListener('timeupdate', () => {
      if(audioPlayer.duration){
        let progressPercent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
        progressBar.value = progressPercent;
        currentTimeEl.textContent = formatTime(audioPlayer.currentTime);
        durationEl.textContent = formatTime(audioPlayer.duration);
      }
    });

    progressBar.addEventListener('input', () => {
      if(audioPlayer.duration){
        let seekTime = (progressBar.value / 100) * audioPlayer.duration;
        audioPlayer.currentTime = seekTime;
      }
    });

    volumeBar.addEventListener('input', () => {
      audioPlayer.volume = volumeBar.value / 100;
    });

    function updatePlayBtn(button, isPlaying){
      if(isPlaying){
        button.textContent = '⏸ Pause';
        button.classList.add('playing');
      } else {
        button.textContent = '▶️ Play';
        button.classList.remove('playing');
      }
    }

    function updateAllPlayButtons(isPlaying){
      playButtons.forEach((btn, idx) => {
        updatePlayBtn(btn, idx === currentTrackIndex && isPlaying);
      });
    }

    function formatTime(seconds){
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // 預設播放模式
    setPlayMode(0);
  </script>
</body>
</html>
